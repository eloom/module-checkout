define(["jquery","uiRegistry","Eloom_Checkout/js/action/check-taxvat-availability","Magento_Checkout/js/model/full-screen-loader","mage/translate"],function(a,g,h,e){var c=null,f=0,k=function(b){c=a.Deferred();h(c,b.val());a.when(c).done(function(){b.removeClass("unique-taxvat-error").next(".unique-taxvat-error").remove();a("button[data-role=opc-continue]").prop("disabled",!1)}.bind(this)).fail(function(){0==b.next(".unique-taxvat-error").length&&(b.addClass("unique-taxvat-error").after('<div class="mage-error unique-taxvat-error" data-bind="attr: { id: element.errorId }, text: element.error" generated="true" id="unique-taxvat-error">'+
a.mage.__("Taxvat already registered")+"</div>"),a("button[data-role=opc-continue]").prop("disabled",!0))}.bind(this)).always(function(){e.stopLoader()}.bind(this))};return function(b){g.async("checkoutProvider")(function(l){l.on("shippingAddress",function(n){try{a('div[name$=".taxvat"] input[type="text"]').each(function(d){a(this).data("unique-taxvat")||(a(this).data("unique-taxvat",!0),a(this).metadata().validate?a(this).metadata().validate["validate-unique-taxvat"]=!0:a(this).metadata().validate=
{"validate-unique-taxvat":!0},a(this).blur(function(){e.startLoader();var m=a(this);clearTimeout(f);f=setTimeout(function(){k(m)},2E3)}))})}catch(d){(console.error||console.log).call(console,d.message||d)}})});return b}});
